{
    "metadata": {
        "name": "update-activation"
    },
    "spec": {
        "campaign": "update:v1",
        "stage": "",
        "inputs": {
            "app-to-update": "emergency-brake",
            "conditions": {
                "vehicle_state": {
                    "engine_status": "stopped",
                    "gear": "park",
                    "speed_kmh": 0,
                    "location": {
                    "latitude": 52.520008,
                    "longitude": 13.404954,
                    "altitude": 34.5,
                    "country" : "Portugal"
                    },
                    "doors": {
                    "driver": "closed",
                    "passenger": "closed",
                    "rear_left": "closed",
                    "rear_right": "closed"
                    }
                },
                "battery_status": {
                    "charging": true
                }
            },
            "rollback": {
                "metadata": {
                    "name": "ankaios-target"
                },
                "spec": {
                    "forceRedeploy": true,
                    "components": [
                        {
                            "name": "emergency-brake",   
                            "type": "ankaios",             
                            "properties": {
                                "ankaios.runtime": "podman",
                                "ankaios.agent": "agent_A",
                                "ankaios.tags": [
                                    {
                                        "ankaios.key": "version",
                                        "ankaios.value": "v0.0.1"
                                    }
                                ],
                                "ankaios.restartPolicy": "ALWAYS",
                                "ankaios.runtimeConfig": "image: docker.io/library/nginx\ncommandOptions: [\"-p\", \"8080:80\"]"                
                            }
                        }
                    ],
                    "topologies": [
                        {
                            "bindings": [
                                {
                                    "role": "ankaios",
                                    "provider": "providers.target.mqtt",
                                    "config": {
                                        "name": "proxy",
                                        "brokerAddress": "tcp://127.0.0.1:1883",
                                        "clientID": "symphony",
                                        "requestTopic": "coa-request",
                                        "responseTopic": "coa-response",
                                        "timeoutSeconds":  "30"
                                    }
                                }
                            ]
                        }
                    ]
                }
            },
            "target": {
                "metadata": {
                    "name": "ankaios-target"
                },
                "spec": {
                    "forceRedeploy": true,
                    "components": [
                        {
                            "name": "emergency-brake",   
                            "type": "ankaios",             
                            "properties": {
                                "ankaios.runtime": "podman",
                                "ankaios.agent": "agent_A",
                                "ankaios.tags": [
                                    {
                                        "ankaios.key": "version",
                                        "ankaios.value": "v0.0.2"
                                    }
                                ],
                                "ankaios.restartPolicy": "ALWAYS",
                                "ankaios.runtimeConfig": "image: docker.io/library/nginx\ncommandOptions: [\"-p\", \"9090:80\"]"                   
                            }
                        }
                    ],
                    "topologies": [
                        {
                            "bindings": [
                                {
                                    "role": "ankaios",
                                    "provider": "providers.target.mqtt",
                                    "config": {
                                        "name": "proxy",
                                        "brokerAddress": "tcp://127.0.0.1:1883",
                                        "clientID": "symphony",
                                        "requestTopic": "coa-request",
                                        "responseTopic": "coa-response",
                                        "timeoutSeconds":  "30"
                                    }
                                }
                            ]
                        }
                    ]
                }
            }
        }
    }
}